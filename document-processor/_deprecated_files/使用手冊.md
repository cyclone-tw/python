# 公文智能處理系統 - 使用手冊

## 📋 系統簡介

公文智能處理系統是一個自動化的文件處理工具，能夠：
- 🔍 自動掃描指定目錄中的 `*_print.pdf` 公文檔案
- 🤖 使用 Gemini AI 分析公文內容
- 📁 智能重命名並歸檔文件（包含附件）
- 📅 自動建立 Google Calendar 事件或 Google Tasks 任務
- 📝 生成詳細的處理記錄

## 🚀 快速開始

### 1. 啟動系統
```bash
cd "C:\Users\Admin\Claude.ai\Python-公文智能處理系統"
python main.py
```

### 2. 系統流程
系統會按照以下步驟執行：

#### 步驟 1：掃描公文
- 系統會掃描 `G:\我的雲端硬碟\00.Inbox` 目錄
- 只處理 `*_print.pdf` 格式的檔案
- 自動識別相同前綴的附件檔案

#### 步驟 2：AI 分析
- 使用 Gemini AI 分析每份公文內容
- 提取關鍵資訊：主旨、文件類型、重要性、截止日期等
- 建議檔案名稱和 Google 整合方式

#### 步驟 3：Google 整合
對每份公文，你可以選擇：
1. **建立行事曆事件** - 適合有特定日期的活動或會議
2. **建立 Tasks 任務** - 適合需要執行的待辦事項
3. **跳過** - 不建立任何 Google 項目

系統會顯示分析摘要和建議，並讓你確認日期和內容。

#### 步驟 4：歸檔公文
- 自動將公文和附件搬移到 `G:\我的雲端硬碟\01.公文智能歸檔`
- 使用智能命名：`YYYY-MM-DD_公文主旨`
- 每個公文會有獨立的資料夾
- 生成詳細的處理記錄

## 📁 檔案結構

### 輸入目錄 (Inbox)
```
G:\我的雲端硬碟\00.Inbox\
├── 376480000A_1140211977_print.pdf    # 主要公文
├── 376480000A_1140211977_ATTACH1.pdf  # 附件1
├── 376480000A_1140211977_ATTACH2.pdf  # 附件2
└── ...
```

### 輸出目錄 (歸檔)
```
G:\我的雲端硬碟\01.公文智能歸檔\
├── 2024-12-15_教師研習通知\
│   ├── 2024-12-15_教師研習通知.pdf     # 重命名的主文件
│   ├── 376480000A_1140211977_ATTACH1.pdf  # 附件
│   ├── 376480000A_1140211977_ATTACH2.pdf  # 附件
│   └── 處理記錄.txt                      # AI分析與Google整合記錄
└── ...
```

## 🔧 重要功能

### 智能檔名識別
- 系統會識別 `前綴_數字_print.pdf` 格式
- 自動搜尋相同前綴的所有附件
- 支援英數字前綴（如：`376480000A_`）

### 覆蓋機制
- 如果發現重複的公文（相同檔名），系統會：
  - 保留目標資料夾結構
  - 覆蓋舊的檔案內容
  - 更新處理記錄

### Google 整合確認
在建立 Google 事件或任務前，系統會：
1. 顯示 AI 分析摘要
2. 展示建議的標題和日期
3. 讓你手動確認或修改日期
4. 確認後才建立

## 📝 處理記錄內容

每個歸檔的公文都會包含 `處理記錄.txt`，內容包括：
- 📋 AI 分析結果（主旨、類型、重要性）
- 📅 重要日期和行動項目
- 👤 聯絡資訊
- 🔗 Google 整合記錄（事件/任務連結）

## ⚠️ 注意事項

1. **檔案格式**：只處理 `*_print.pdf` 檔案
2. **網路連線**：需要穩定的網路連線以使用 Gemini AI 和 Google API
3. **權限設定**：確保 Google 帳號已授權存取 Calendar 和 Tasks
4. **目錄權限**：確保系統對 Inbox 和歸檔目錄有讀寫權限

## 🎯 使用技巧

### 日期輸入格式
當系統要求手動輸入日期時，支援以下格式：
- `2024-12-25` （設定為上午9點）
- `2024-12-25 14:30` （指定具體時間）

### 批次處理
- 可以選擇處理單一公文或全部公文
- 建議先處理一份測試，確認結果無誤後再批次處理

### 錯誤處理
如果遇到錯誤：
1. 檢查網路連線
2. 確認 API 金鑰有效
3. 檢查目錄權限
4. 查看 `error.txt` 錯誤記錄

## 📞 技術支援

如有問題請檢查：
1. `error.txt` - 系統錯誤記錄
2. `處理記錄.txt` - 個別公文處理狀況
3. 網路連線和 API 服務狀態